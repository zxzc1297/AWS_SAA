# 문제 풀이 노트 (53-56편)

[↩️ 메인으로 돌아가기](../README.md)

---

## 문제 53: 고성능 OLTP 데이터베이스를 위한 EBS 볼륨 유형 선택

> **시나리오:**
> 한 회사는 대규모 EC2 인스턴스에서 높은 트랜잭션을 처리하는 관계형 데이터베이스(PostgreSQL)를 운영하고 있습니다. 이 데이터베이스는 비즈니스에 매우 중요한 온라인 트랜잭션 처리(OLTP) 워크로드를 담당하며, 초당 수많은 소규모 랜덤 읽기 및 쓰기 작업을 처리합니다. 최근 스토리지의 IOPS(초당 입출력 작업 수)가 한계에 도달하여 성능 병목이 발생하고 있습니다. 현재 데이터베이스는 EBS 범용 SSD (gp3) 볼륨을 사용하고 있습니다.
>
> **요구사항:**
> 1.  **최대 IOPS:** IOPS 성능을 대폭 향상시켜야 합니다.
> 2.  **낮은 지연 시간:** 스토리지 응답은 일관되게 낮은 지연 시간을 제공해야 합니다.
> 3.  **높은 내구성:** 스토리지 솔루션은 내구성과 복원력이 높아야 합니다.
> 4.  **애플리케이션 변경 없음:** 데이터베이스 애플리케이션의 코드를 변경해서는 안 됩니다.
>
> **문제:**
> 이러한 요구사항을 가장 잘 충족하는 솔루션은 무엇입니까?
>
> A. EBS 볼륨을 처리량 최적화 HDD (st1)로 교체합니다.
> B. 계속해서 범용 SSD (gp3) 볼륨을 사용하되, 프로비저닝된 IOPS와 처리량을 최댓값으로 증설합니다.
> C. 데이터베이스를 로컬 NVMe SSD 인스턴스 스토어(Instance Store)가 있는 EC2 인스턴스로 마이그레이션합니다.
> D. 현재 EBS 볼륨을 분리하고 프로비저닝된 IOPS SSD (io2) 볼륨으로 교체합니다.

### 풀이 및 정리

✅ **정답: D**

- **솔루션 분석:** 해결책은 OLTP 워크로드의 IOPS 병목 현상을 해결해야 합니다. **프로비저닝된 IOPS SSD(io2)** 볼륨은 I/O 집약적이고 낮은 지연 시간이 요구되는 데이터베이스 워크로드에 최적화되어 있어 가장 적합합니다. `st1`은 순차 I/O, `gp3`는 `io2`보다 성능 한계치가 낮으며, 인스턴스 스토어는 비휘발성(non-persistent)이므로 내구성 요구사항을 위반합니다.

- **핵심 개념: Amazon EBS 볼륨 유형 비교**
| EBS 볼륨 유형 | **주요 특징** | **최적 워크로드** | **주요 성능 지표** |
| :--- | :--- | :--- | :--- |
| **프로비저닝된 IOPS SSD (`io2`/`io1`)** | **최고 성능 SSD**, 일관된 저지연 | **I/O 집약적인 대규모 관계형/NoSQL DB (OLTP)** | **IOPS** |
| **범용 SSD (`gp3`/`gp2`)** | **가격과 성능의 균형**, 대부분의 워크로드에 적합 | 부팅 볼륨, 개발/테스트 환경, 중소규모 DB | IOPS |
| **처리량 최적화 HDD (`st1`)**| 낮은 비용의 마그네틱 스토리지 | **데이터 웨어하우스, 로그 처리** 등 대규모 순차 I/O | **처리량 (Throughput)** |
| **콜드 HDD (`sc1`)** | 가장 저렴한 마그네틱 스토리지 | 거의 액세스하지 않는 데이터의 아카이브 | 처리량 (Throughput) |


---

## 문제 54: EC2 인스턴스에서 실행되는 애플리케이션에 대한 안전한 AWS 서비스 접근 권한 부여

> **시나리오:**
> 한 회사는 여러 EC2 인스턴스에서 데이터 처리 애플리케이션을 실행하고 있습니다. 이 애플리케이션은 Amazon S3 버킷에서 데이터를 읽고, 처리된 결과를 Amazon DynamoDB 테이블에 써야 합니다. 현재 개발자가 발급받은 장기 액세스 키와 비밀 키를 EC2 인스턴스의 구성 파일에 하드코딩하여 사용하고 있어 보안 감사에서 지적되었습니다.
>
> **요구사항:**
> 1.  **장기 자격 증명 제거:** 인스턴스에 저장된 정적(static)인 장기 액세스 키를 사용하지 않아야 합니다.
> 2.  **최소 권한 원칙:** 애플리케이션은 작업을 수행하는 데 필요한 최소한의 권한만 가져야 합니다.
> 3.  **자동 자격 증명 교체:** 애플리케이션이 사용하는 자격 증명은 자동으로 교체되는 단기(short-lived) 자격 증명이어야 합니다.
> 4.  **확장성:** 솔루션은 Auto Scaling 그룹에 의해 새로 시작되는 인스턴스를 포함한 모든 EC2 인스턴스에 적용 가능해야 합니다.
>
> **문제:**
> 이러한 요구사항을 모두 충족하는 가장 안전하고 모범적인 방법은 무엇입니까?
>
> A. IAM 사용자의 액세스 키를 AWS Secrets Manager에 저장하고, 애플리케이션이 시작 시 검색하여 사용하도록 합니다.
> B. 필요한 권한을 부여하는 IAM 정책을 생성하고, 이 정책을 **IAM 역할(Role)**에 연결합니다. 이 IAM 역할을 **인스턴스 프로파일(Instance Profile)**을 사용하여 EC2 인스턴스에 연결합니다.
> C. API Gateway와 AWS Lambda 함수를 통해 데이터 접근을 중개하도록 아키텍처를 변경합니다.
> D. 애플리케이션이 IAM 사용자의 자격 증명을 사용하여 `sts:AssumeRole` API를 직접 호출하도록 수정합니다.

### 풀이 및 정리

✅ **정답: B**

- **솔루션 분석:** EC2 인스턴스에서 실행되는 애플리케이션에 AWS 서비스 접근 권한을 부여하는 가장 안전하고 표준적인 방법은 **IAM 역할**을 사용하는 것입니다. IAM 역할을 인스턴스 프로파일을 통해 EC2 인스턴스에 연결하면, 애플리케이션은 AWS SDK를 통해 EC2 메타데이터 서비스에서 자동으로 교체되는 임시 자격 증명을 안전하게 받아올 수 있습니다. 이 방식은 장기 액세스 키를 코드나 구성 파일에 저장하는 보안 위험을 근본적으로 제거합니다.

- **핵심 개념: IAM Roles for EC2**
| 컴포넌트 | 역할 | 설명 |
| :--- | :--- | :--- |
| **IAM Role** | 권한의 집합 | EC2 인스턴스가 특정 작업을 수행할 수 있도록 허용하는 권한 세트 |
| **Instance Profile** | 역할 컨테이너 | IAM 역할을 EC2 인스턴스에 전달하는 컨테이너 |
| **EC2 Metadata Service** | 임시 자격 증명 제공 | 인스턴스가 `169.254.169.254`로 요청하여 임시 자격 증명을 획득하는 내부 서비스 |


---

## 문제 55: S3 리전 간 데이터 전송 비용 최적화

> **시나리오:**
> 애플리케이션 백엔드와 S3 버킷은 미국 동부(`us-east-1`) 리전에 있지만, 유럽 사용자도 많습니다. 유럽 사용자들이 S3의 대용량 파일을 다운로드할 때마다 비싼 리전 간 'Data Transfer Out' 비용이 많이 발생하고 있습니다.
>
> **요구사항:**
> 1.  **데이터 전송 비용 절감:** 유럽 사용자가 S3 데이터에 접근할 때 발생하는 데이터 전송 비용을 대폭 절감해야 합니다.
> 2.  **성능 개선:** 유럽 사용자들의 다운로드 속도도 개선되어야 합니다.
> 3.  **최소한의 애플리케이션 변경:** 애플리케이션 코드의 큰 변경 없이 솔루션을 구현해야 합니다.
>
> **문제:**
> 이러한 요구사항을 모두 충족하는 가장 비용 효율적인 솔루션은 무엇입니까?
>
> A. S3 교차 리전 복제(CRR)를 사용하여 유럽 리전에 버킷 복사본을 만듭니다.
> B. `us-east-1` S3 버킷에 S3 Transfer Acceleration을 활성화합니다.
> C. **Amazon CloudFront** 배포를 생성하고 `us-east-1` S3 버킷을 오리진(Origin)으로 설정합니다. 애플리케이션이 파일 URL을 CloudFront 도메인으로 제공하도록 업데이트합니다.
> D. 유럽과 `us-east-1` 리전 간에 AWS Direct Connect 링크를 설정합니다.

### 풀이 및 정리

✅ **정답: C**

- **솔루션 분석:** **Amazon CloudFront**는 글로벌 사용자에게 콘텐츠를 배포할 때 성능과 비용을 모두 최적화하는 CDN 서비스입니다. CloudFront는 S3의 콘텐츠를 사용자와 가까운 전 세계 엣지 로케이션에 캐싱합니다. 이를 통해 사용자는 낮은 지연 시간으로 콘텐츠를 다운로드할 수 있으며, 비싼 S3 리전 간 데이터 전송 비용이 훨씬 저렴한 CloudFront 엣지 데이터 전송 비용으로 대체되어 비용이 크게 절감됩니다. 애플리케이션 변경은 URL 엔드포인트를 변경하는 수준으로 최소화됩니다.

- **핵심 개념: CloudFront vs. S3 Transfer Acceleration**
| 서비스 | **Amazon CloudFront** | **S3 Transfer Acceleration** |
| :--- | :--- | :--- |
| **주요 목적** | **콘텐츠 전송 및 캐싱** (읽기 성능 및 비용 최적화) | **S3로의 장거리 파일 업로드 가속** (쓰기 성능 최적화) |
| **작동 방식** | 엣지 로케이션에 콘텐츠를 캐시하여 사용자에게 제공 | AWS 엣지 네트워크를 통해 S3 버킷까지의 업로드 경로 최적화 |
| **비용 영향** | **데이터 전송 비용 절감** (특히 반복적인 조회 시) | 업로드 속도 향상에 대한 추가 요금 발생 (비용 절감 목적 아님) |


---

## 문제 56: 실시간 스트리밍 데이터 수집 및 처리 아키텍처

> **시나리오:**
> 한 모바일 게임에서 수천 대의 기기가 플레이어 활동 데이터를 지속적인 스트림 형태로 전송합니다. 각 플레이어(`player_id` 기준)의 데이터는 생성된 순서대로 처리되어야 하며, 원본 데이터는 S3에 영구 저장하고, 실시간 데이터는 DynamoDB 순위표를 업데이트하는 데 사용해야 합니다.
>
> **요구사항:**
> 1.  **실시간 수집:** 대규모 스트림을 데이터 손실 없이 수집해야 합니다.
> 2.  **순서 보장 처리:** 플레이어별 데이터는 순서대로 처리되어야 합니다.
> 3.  **영구 저장:** 원본 데이터는 S3에 안정적으로 저장되어야 합니다.
> 4.  **실시간 처리:** 데이터를 거의 실시간으로 처리해야 합니다.
>
> **문제:**
> 이러한 요구사항을 모두 충족하는 가장 적절한 아키텍처는 무엇입니까?
>
> A. 모바일 기기가 데이터를 Amazon SQS FIFO 대기열로 보냅니다.
> B. 모바일 기기가 Amazon API Gateway 엔드포인트로 데이터를 보내 AWS Lambda 함수를 직접 트리거합니다.
> C. 모바일 기기가 **Amazon Kinesis Data Stream**으로 데이터를 전송하며, `player_id`를 **파티션 키**로 사용합니다. **AWS Lambda 함수**가 스트림을 소비하여 DynamoDB를 업데이트하고, **Amazon Kinesis Data Firehose**가 스트림을 S3 버킷으로 자동 전송합니다.
> D. 모바일 기기가 데이터를 Amazon S3 버킷에 직접 기록하고 S3 이벤트를 사용하여 Lambda 함수를 트리거합니다.

### 풀이 및 정리

✅ **정답: C**

- **솔루션 분석:** 이 아키텍처는 AWS의 스트리밍 데이터 서비스를 각 목적에 맞게 조합한 모범 사례입니다. **Kinesis Data Streams**는 `player_id`를 파티션 키로 사용하여 플레이어별 데이터 처리 순서를 보장하며 대규모 데이터를 실시간으로 수집합니다. **Kinesis Data Firehose**는 코딩 없이 스트림 데이터를 S3로 안정적으로 전송(아카이빙)하는 가장 간단한 방법입니다. **AWS Lambda**는 Kinesis Data Stream과 통합하여 수집된 데이터를 실시간으로 처리하는 데 이상적인 소비자 역할을 합니다.

- **핵심 개념: 데이터 수집 서비스 비교 (Kinesis vs. SQS)**
| 구분 | **Amazon Kinesis Data Streams** | **Amazon SQS (FIFO)** |
| :--- | :--- | :--- |
| **주요 모델** | **스트리밍 (Streaming)** - 데이터의 연속적인 흐름 | **큐잉 (Queuing)** - 개별 메시지 처리 |
| **순서 보장** | **파티션 키**를 통해 파티션(샤드) 내에서 보장 | **메시지 그룹 ID**를 통해 그룹 내에서 보장 |
| **데이터 보존** | 기본 24시간, 최대 365일까지 **재생 가능(Replayable)** | 소비자가 삭제할 때까지 보존 (최대 14일) |
| **소비자** | 다수의 소비자가 동일한 스트림을 **독립적으로 읽을 수 있음 (Fan-out)** | 메시지는 한 번에 하나의 소비자에게만 전달됨 |
| **핵심 사용 사례**| 실시간 분석, 로그/이벤트 데이터 수집, IoT 데이터 | 작업 분배, 시스템 디커플링, 비동기 트랜잭션 |

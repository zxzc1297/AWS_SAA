# 문제 풀이 노트 (13-16편)

[↩️ 메인으로 돌아가기](../README.md)

---

## ## 문제 13: 보안 - 웹 애플리케이션을 위한 다계층 방어

> **시나리오:**
> 한 뉴스 미디어 회사는 자사의 웹사이트를 Application Load Balancer(ALB)와 EC2 인스턴스 그룹을 통해 운영하고 있습니다. 최근 이 웹사이트는 SQL 인젝션(SQL Injection) 및 교차 사이트 스크립팅(Cross-Site Scripting, XSS)과 같은 일반적인 웹 취약점을 노리는 공격 시도를 받고 있습니다. 또한, 대규모 트래픽을 유발하여 서비스를 마비시키는 분산 서비스 거부(DDoS) 공격에 대한 우려도 커지고 있습니다.
>
> **요구사항:**
> 1.  SQL 인젝션, XSS와 같은 웹 애플리케이션 계층(Layer 7)의 공격을 필터링하고 차단해야 합니다.
> 2.  네트워크 및 전송 계층의 일반적인 DDoS 공격으로부터 애플리케이션을 보호해야 합니다.
> 3.  솔루션은 AWS의 관리형 서비스를 사용하여 구현해야 하며, 운영 부담이 적어야 합니다.
>
> **문제:** 이러한 보안 요구사항을 가장 효과적으로 충족하는 아키텍처는 무엇입니까?
>
> **A.** ALB에 연결된 보안 그룹(Security Group)에 알려진 악성 IP 주소들을 차단하는 규칙을 수동으로 추가하고, 서브넷의 네트워크 ACL(NACL)을 사용하여 특정 국가의 IP 대역을 거부합니다.
>
> **B.** Application Load Balancer 앞에 **Amazon CloudFront**를 배포하고, CloudFront 배포에 **AWS WAF** 웹 ACL을 연결합니다. 이 웹 ACL에 AWS 관리형 규칙(Managed Rules)을 적용하여 SQL 인젝션과 XSS 공격을 차단합니다.
>
> **C.** 모든 EC2 인스턴스에 서드파티 웹 애플리케이션 방화벽(WAF) 소프트웨어를 직접 설치하고, 각 인스턴스가 악성 요청을 개별적으로 필터링하도록 구성합니다.
>
> **D.** **Amazon GuardDuty**를 활성화하여 악의적인 활동을 탐지합니다. GuardDuty가 위협을 발견하면 Lambda 함수를 실행하여 해당 IP 주소를 ALB의 보안 그룹에 자동으로 추가하여 차단합니다.

---

### ### 풀이 및 정리

✅ **정답: B**

* **정답 분석:** 이 문제에 대한 AWS의 정석적인 해결책은 **`CloudFront` + `WAF` + `Shield`** 라는 '보안 삼총사' 조합입니다. **CloudFront**가 1차 방어선 및 DDoS 공격 흡수(`Shield Standard` 자동 활성화) 역할을 하고, 그 앞에 연결된 **AWS WAF**가 SQL 인젝션과 같은 Layer 7 공격을 정밀하게 필터링합니다. 이렇게 여러 계층에 걸쳐 방어막을 치는 것이 효과적인 보안 아키텍처의 핵심입니다.

* **핵심 개념:** AWS 웹 보안 서비스의 역할 구분

| 서비스 | **AWS WAF** | **AWS Shield** | **Amazon GuardDuty** | **보안 그룹 / NACL** |
| :--- | :--- | :--- | :--- | :--- |
| **보호 계층** | **Layer 7** (애플리케이션) | **Layer 3/4/7** (네트워크/전송/앱) | (분석 대상) | **Layer 3/4** (네트워크/전송) |
| **주요 기능** | 웹 요청 필터링 (**예방**) | DDoS 공격 완화 (**예방**) | 위협 **탐지** 및 경고 | IP/포트 기반 트래픽 제어 |
| **차단 대상** | SQL 인젝션, XSS 등 | 비정상적 대규모 트래픽 | (직접 차단 안 함) | 특정 IP, 포트, 프로토콜 |

---

## ## 문제 14: 탄력성 - '죽지 않는' 데이터베이스 만들기

> **시나리오:**
> 한 기업은 자사의 핵심 애플리케이션 데이터베이스를 단일 EC2 인스턴스에 직접 설치한 PostgreSQL 데이터베이스로 운영하고 있습니다. 최근 이 EC2 인스턴스가 위치한 가용 영역(Availability Zone)에 일시적인 문제가 생겨, 몇 시간 동안 데이터베이스 서비스가 중단되는 사고가 발생했습니다.
>
> **요구사항:**
> 1.  데이터베이스의 고가용성(High Availability)을 확보해야 합니다.
> 2.  장애 발생 시, 사람의 개입 없이 자동으로 장애 조치(failover)가 이루어져야 합니다.
> 3.  장애 조치 시 데이터 손실이 거의 없어야 합니다(낮은 RPO).
> 4.  솔루션의 관리 부담이 적어야 합니다.
>
> **문제:** 이 요구사항을 가장 효과적이고 관리 부담이 적게 충족하는 솔루션은 무엇입니까?
>
> **A.** EC2 인스턴스에 대한 Auto Scaling 그룹을 생성하고, 최소 및 최대 용량을 1로 설정합니다. 인스턴스 장애 시 Auto Scaling이 자동으로 새 인스턴스를 시작하도록 구성합니다.
>
> **B.** 데이터베이스를 **Amazon RDS for PostgreSQL**로 마이그레이션하고, 다른 가용 영역에 **읽기 전용 복제본(Read Replica)**을 생성합니다. 주 인스턴스에 장애가 발생하면, 읽기 전용 복제본을 새로운 주 인스턴스로 수동 승격시킵니다.
>
> **C.** 다른 가용 영역에 두 번째 EC2 인스턴스를 생성하고, PostgreSQL의 스트리밍 복제(Streaming Replication)를 직접 구성합니다. 주 인스턴스의 장애를 감지하여 보조 인스턴스로 연결을 전환하는 별도의 모니터링 및 페일오버 스크립트를 개발합니다.
>
> **D.** 데이터베이스를 **Amazon RDS for PostgreSQL**로 마이그레이션하고, **다중 AZ(Multi-AZ) 배포** 옵션을 활성화합니다.

---

### ### 풀이 및 정리

✅ **정답: D**

* **정답 분석:** '자동 장애 조치'와 '최소한의 데이터 손실'이라는 요구사항에는 **`RDS 다중 AZ(Multi-AZ)`**가 유일한 정답입니다. 다중 AZ는 다른 가용 영역에 **동기식**으로 복제되는 대기(Standby) 데이터베이스를 두어, 장애 발생 시 AWS가 **자동으로** DNS를 전환하여 서비스를 복구해주는 고가용성(HA) 전용 기능이기 때문입니다.

* **핵심 개념:** 다중 AZ vs. 읽기 전용 복제본 비교

| 구분 | **다중 AZ (Multi-AZ)** | **읽기 전용 복제본 (Read Replica)** |
| :--- | :--- | :--- |
| **주 목적** | **고가용성 (HA), 장애 복구** | **읽기 성능 확장 (Read Scaling)** |
| **복제 방식** | **동기식 (Synchronous)** | **비동기식 (Asynchronous)** |
| **장애 조치** | **자동 (Automatic)** | **수동 (Manual Promotion)** |
| **데이터 손실(RPO)** | 거의 없음 (Near-Zero) | 복제 지연만큼 발생 가능 |
| **대기 DB 접근** | 불가능 | 가능 (읽기 전용) |

---

## ## 문제 15: 고성능 - 전 세계 사용자를 가장 빠르게 연결하기

> **시나리오:**
> 한 글로벌 뉴스 회사는 전 세계 사용자들에게 개인화된 뉴스 피드를 제공하는 동적 웹 애플리케이션을 여러 AWS 리전(미국, 유럽, 아시아)에 배포하여 운영하고 있습니다. 회사는 다음 두 가지 목표를 통해 사용자 경험을 극대화하고자 합니다.
>
> 1.  모든 사용자는 네트워크 지연 시간(latency)이 가장 낮은 리전으로 자동 연결되어야 합니다.
> 2.  API 응답은 사용자마다 개인화되어 동적이지만, 일부 공통 데이터는 1분 정도의 짧은 시간 동안 캐싱하여 응답 속도를 더욱 향상시키고 오리진 서버의 부하를 줄이고 싶습니다.
>
> **문제:** 이러한 요구사항을 가장 포괄적으로 충족하는 솔루션은 무엇입니까?
>
> **A.** **AWS Global Accelerator**를 설정하고 여러 리전의 애플리케이션 엔드포인트를 등록하여, AWS 글로벌 네트워크를 통해 사용자를 최적의 엔드포인트로 라우팅합니다.
>
> **B.** **Amazon Route 53**에서 **지연 시간 기반 라우팅(Latency-based routing)** 정책을 사용하여 각 리전의 엔드포인트를 등록합니다. 또한, **Amazon CloudFront**를 애플리케이션 앞에 배포하고, 캐시 정책을 구성하여 짧은 TTL(Time To Live)로 API 응답을 캐싱합니다.
>
> **C.** **Amazon Route 53**에서 **장애 조치(Failover) 라우팅** 정책을 사용하여 주 리전을 설정하고, 다른 리전들을 대기 리전으로 구성하여 가용성을 확보합니다.
>
> **D.** 각 리전의 Application Load Balancer 앞에 **Amazon ElastiCache for Redis** 클러스터를 배포하여 각 리전 내에서 API 응답을 캐싱하고, **Amazon Route 53**의 **가중치 기반 라우팅(Weighted routing)**으로 트래픽을 리전 간에 분산합니다.

---

### ### 풀이 및 정리

✅ **정답: B**

* **정답 분석:** 이 문제는 '글로벌 라우팅'과 '콘텐츠 캐싱'이라는 두 가지 요구사항을 모두 충족해야 하는 점이 핵심이었습니다. `AWS Global Accelerator`(A)가 라우팅은 잘해주지만 캐싱 기능은 없다는 점을 알게 되었습니다. 따라서 각 요구사항을 가장 잘 해결하는 두 서비스를 조합하는 B가 정답이었습니다. **`Route 53 지연 시간 기반 라우팅`**이 사용자를 가장 가까운 리전으로 1차 안내하고, **`CloudFront`**가 엣지에서 2차로 캐싱하여 응답 속도를 극대화합니다.

* **핵심 개념:** CloudFront와 Global Accelerator 비교

| 구분 | **Amazon CloudFront** | **AWS Global Accelerator** |
| :--- | :--- | :--- |
| **주요 프로토콜** | **HTTP/HTTPS (웹 트래픽)** | **TCP/UDP (모든 트래픽)** |
| **핵심 기능** | **콘텐츠 캐싱 (Caching)** | **네트워크 경로 최적화 (Path Optimization)** |
| **주요 사용 사례** | 웹사이트, API, 비디오 스트리밍, 정적/동적 콘텐츠 전송 | 게임, VoIP, IoT, 고정 IP가 필요한 비 HTTP 애플리케이션 |
| **핵심 질문** | "콘텐츠를 **캐싱**해야 하는가?" → **CloudFront** | "네트워크 지연에 민감한 **실시간 양방향 통신**인가?" → **Global Accelerator** |

---

## ## 문제 16: 보안 - 프라이빗 서버에 접속하는 가장 현대적인 방법

> **시나리오:**
> 한 기업의 운영팀은 회사의 핵심 애플리케이션 서버들을 외부에서 접근할 수 없는 **프라이빗 서브넷**의 EC2 인스턴스에서 운영하고 있습니다. 운영자들은 문제 해결 및 유지보수를 위해 사무실이나 재택근무 환경에서 이 프라이빗 인스턴스의 쉘(Shell)에 안전하게 접속해야 합니다.
>
> **요구사항:**
> 1.  인스턴스의 SSH(22번) 포트를 인터넷에 개방해서는 안 됩니다.
> 2.  별도의 배스천 호스트(Bastion Host)나 VPN 서버를 구축하고 관리하는 운영 부담을 피하고 싶습니다.
> 3.  모든 원격 접속 세션 중 실행된 명령어는 나중에 감사할 수 있도록 반드시 기록되어야 합니다.
>
> **문제:** 이 모든 요구사항을 충족하는 가장 안전하고 효율적인 솔루션은 무엇입니까?
>
> **A.** 퍼블릭 서브넷에 배스천 호스트를 배치합니다. 운영자들은 먼저 이 배스천 호스트에 SSH로 접속한 후, 터널링을 통해 프라이빗 EC2 인스턴스에 접속하도록 구성합니다.
>
> **B.** EC2 인스턴스가 있는 VPC와 회사 사무실 네트워크 간에 **AWS Site-to-Site VPN** 터널을 생성하여, 사무실 내에서만 프라이빗 IP로 직접 접속하도록 허용합니다.
>
> **C.** **AWS Systems Manager Session Manager**를 사용합니다. 모든 EC2 인스턴스에 SSM Agent를 설치하고 필요한 IAM 역할을 부여합니다. 운영자들은 IAM 자격 증명을 사용하여 웹 콘솔이나 AWS CLI를 통해 인스턴스에 접속하고, 세션 활동 로깅을 활성화합니다.
>
> **D.** 운영자가 접속해야 할 때마다 해당 EC2 인스턴스에 임시로 탄력적 IP(Elastic IP)를 할당하고, 운영자의 IP 주소에 대해서만 SSH 포트를 개방하는 스크립트를 실행합니다. 작업이 끝나면 스크립트를 통해 다시 IP를 회수하고 포트를 차단합니다.

---

### ### 풀이 및 정리

✅ **정답: C**

* **정답 분석:** **`AWS Systems Manager Session Manager`**는 'VPN/배스천 없이', 'SSH 포트 없이', '안전하고 감사 가능하게' 프라이빗 인스턴스에 접속하는 시나리오의 정답입니다. IAM 기반으로 접근을 제어하고 모든 세션 기록을 로그로 남길 수 있어, 문제의 모든 요구사항을 완벽하게 충족하는 가장 현대적인 솔루션입니다.

* **핵심 개념:** 프라이빗 인스턴스 접속 방법 비교

| 방법 | **배스천 호스트** | **AWS Site-to-Site VPN** | **AWS Systems Manager Session Manager** |
| :--- | :--- | :--- | :--- |
| **주요 용도** | 프라이빗 리소스에 대한 프록시/점프 서버 | **네트워크 대 네트워크** 연결 | **IAM 기반**의 안전한 인스턴스 쉘 접근 |
| **인프라 관리** | 필요 (EC2 인스턴스) | 필요 (고객 게이트웨이 등) | **불필요 (서버리스)** |
| **재택/원격 근무** | 가능 | 불가능 (Client VPN 필요) | **가능** |
| **명령어 감사** | 직접 구현 필요 | 불가능 | **기본 기능으로 제공** |
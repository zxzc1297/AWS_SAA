# 문제 풀이 노트 (21-24편)

[↩️ 메인으로 돌아가기](../README.md)

---

## ## 문제 21: 고성능 - 데이터베이스, 역할에 맞게 분리하기

> **시나리오:**
> 한 이커머스 기업은 실시간 고객 주문을 처리하는 웹사이트와, 내부 비즈니스 인텔리전스(BI)팀이 사용하는 분석 대시보드를 운영하고 있습니다. 이 두 시스템은 현재 단일 **Amazon RDS for MySQL** 데이터베이스 인스턴스를 공유하고 있습니다.
>
> 문제는 BI팀이 분기별 매출 통계와 같이 복잡하고 무거운 분석 쿼리를 실행할 때마다, 데이터베이스의 CPU와 I/O 사용률이 급증하여 실시간 웹사이트의 성능에 심각한 영향을 미친다는 것입니다.
>
> **요구사항:**
> 1. 웹사이트의 실시간 트랜잭션 처리 성능에 영향을 주지 않아야 합니다.
> 2. BI팀은 분석 쿼리를 자유롭게 실행할 수 있어야 합니다.
> 3. 분석용 데이터는 실시간 데이터와 수 분 이내의 차이를 유지해야 합니다.
>
> **문제:** 이러한 요구사항을 충족하는 가장 효과적이고 비용 효율적인 방법은 무엇입니까?
>
> **A.** RDS 데이터베이스의 인스턴스 사양을 더 높은 등급으로 올리고(수직 확장), 프로비저닝된 IOPS를 늘려 전체적인 처리 용량을 확보합니다.
>
> **B.** RDS 데이터베이스에 **다중 AZ(Multi-AZ)** 배포를 활성화하고, BI 쿼리는 대기(Standby) 인스턴스로 보내 부하를 분산합니다.
>
> **C.** 주 데이터베이스의 **읽기 전용 복제본(Read Replica)**을 생성하고, 모든 BI 분석 쿼리를 이 복제본의 엔드포인트로 전송하도록 구성합니다.
>
> **D.** 매일 밤 AWS Glue 작업을 실행하여 RDS의 데이터를 추출하고 Amazon Redshift 데이터 웨어하우스로 로드합니다. BI팀은 Redshift를 사용하여 분석 쿼리를 실행합니다.

---

### ### 풀이 및 정리

✅ **정답: C**

* **정답 분석:** 이 문제의 핵심은 서로 다른 워크로드인 **OLTP(온라인 트랜잭션 처리)**와 **OLAP(온라인 분석 처리)**를 분리하는 것이었습니다. 실시간 주문 처리(OLTP)와 무거운 분석 쿼리(OLAP)가 하나의 DB에서 리소스를 두고 경쟁하니 성능 저하가 발생한 것이죠. 이럴 때 사용하는 가장 확실한 해결책이 바로 **`RDS 읽기 전용 복제본(Read Replica)`**이었습니다. 주 데이터베이스는 OLTP 작업만 처리하게 하고, 모든 무거운 OLAP 쿼리는 읽기 전용 복제본으로 보내는 것입니다.

* **핵심 개념:** OLTP와 OLAP 워크로드 분리

| 구분 | **OLTP (Online Transaction Processing)** | **OLAP (Online Analytical Processing)** |
| :--- | :--- | :--- |
| **작업 유형** | 작고 빠른 다수의 읽기/쓰기 (예: 주문 생성, 재고 확인) | 크고 복잡한 소수의 읽기 (예: 분기별 매출 통계) |
| **처리 대상** | 실시간 사용자 트랜잭션 | BI 및 분석 쿼리 |
| **권장 RDS 구성** | **주(Primary) 데이터베이스** | **읽기 전용 복제본 (Read Replica)** |

---

## ## 문제 22: 보안 - 더 이상 코드에 비밀번호는 없다

> **시나리오:**
> 한 금융 애플리케이션이 Amazon EC2 인스턴스에서 실행되며, 고객 데이터를 저장하는 Amazon RDS 데이터베이스에 연결해야 합니다. 현재 데이터베이스의 사용자 이름과 암호가 애플리케이션의 소스 코드 내부에 평문으로 하드코딩되어 있어, 보안팀으로부터 즉시 시정하라는 요구를 받았습니다.
>
> **요구사항:**
> 1.  소스 코드에서 데이터베이스 자격 증명을 완전히 제거해야 합니다.
> 2.  자격 증명을 중앙에서 암호화하여 안전하게 저장하고, IAM을 통해 접근을 통제해야 합니다.
> 3.  보안 강화를 위해, 30일마다 데이터베이스 암호를 **자동으로 교체**해야 합니다. 이 교체 과정에서 애플리케이션의 재시작이나 코드 수정이 발생해서는 안 됩니다.
>
> **문제:** 다음 중 이 모든 요구사항을 가장 잘 충족하는 솔루션은 무엇입니까?
>
> **A.** 데이터베이스 자격 증명을 **AWS Systems Manager Parameter Store**에 `SecureString` 타입으로 저장합니다. EC2의 IAM 역할에 파라미터를 읽을 권한을 부여하고, 30일마다 수동으로 암호를 변경하고 파라미터 값을 업데이트합니다.
>
> **B.** 데이터베이스 자격 증명을 **AWS Secrets Manager**에 저장하고, RDS 데이터베이스와 통합된 **자동 암호 교체(automatic rotation)** 기능을 30일 주기로 활성화합니다. 애플리케이션은 EC2의 IAM 역할을 통해 런타임에 Secrets Manager에서 최신 자격 증명을 가져오도록 수정합니다.
>
> **C.** 데이터베이스 자격 증명을 암호화된 파일에 저장한 후, 접근이 엄격하게 통제된 S3 버킷에 업로드합니다. 30일마다 관리자가 수동으로 암호를 변경하고 S3 파일을 교체합니다.
>
> **D.** EC2 인스턴스를 시작할 때 **사용자 데이터(user data)** 스크립트를 통해 자격 증명을 환경 변수로 인스턴스에 전달하고, 애플리케이션이 이를 읽어 사용하도록 합니다.

---

### ### 풀이 및 정리

✅ **정답: B**

* **정답 분석:** `SSM Parameter Store`(A)도 비밀 정보를 저장할 수 있어 헷갈렸지만, 문제의 핵심 요구사항은 **'자동 암호 교체'**였습니다. 이 기능을 네이티브로, 그리고 RDS와 완벽하게 통합하여 제공하는 서비스는 바로 **`AWS Secrets Manager`**가 유일합니다. Secrets Manager는 단순히 비밀을 저장하는 것을 넘어, 정해진 주기마다 실제 DB 암호를 바꾸고 저장된 값까지 스스로 업데이트해주는 강력한 기능을 제공합니다.

* **핵심 개념:** Secrets Manager와 SSM Parameter Store 비교

| 구분 | **AWS Secrets Manager** | **SSM Parameter Store (`SecureString`)** |
| :--- | :--- | :--- |
| **핵심 기능** | **자동 암호 교체(Rotation)**, 보안 암호 관리 | 일반 구성 데이터 및 보안 문자열 저장 |
| **비용** | 보안 암호당 월 요금 + API 호출 요금 (상대적으로 높음) | 표준 파라미터는 무료, 고급 파라미터 및 API 호출에 요금 (상대적으로 저렴) |
| **최적 사용 사례** | **DB 자격 증명, API 키** 등 주기적인 **자동 교체**가 필요한 경우 | **암호 교체가 필요 없는** DB 연결 문자열, 라이선스 키, 일반 설정값 등 |

---

## ## 문제 23: 탄력성 - 전 세계에 콘텐츠를 빠르고 안전하게

> **시나리오:**
> 한 글로벌 사진 공유 애플리케이션은 전 세계 사용자들이 사진을 업로드하고 조회할 수 있도록 합니다. 이 애플리케이션의 핵심 데이터인 사진 파일은 안정적으로 보관되고 전 세계 어디서든 빠르게 접근할 수 있어야 합니다.
>
> **요구사항:**
> 1.  사진 파일은 매우 높은 **내구성**과 **가용성**으로 저장되어야 합니다.
> 2.  전 세계 모든 사용자는 사진을 다운로드할 때 **낮은 지연 시간**을 경험해야 합니다.
> 3.  주(Primary) AWS 리전 전체에 장애가 발생하는 드문 상황에서도, 최소한의 데이터 손실로 다른 리전에서 사진 서비스를 계속할 수 있어야 합니다 (**재해 복구**).
>
> **문제:** 이러한 요구사항을 가장 포괄적으로 충족하는 스토리지 및 전송 아-키텍처는 무엇입니까?
>
> **A.** 단일 리전의 **Amazon S3** 버킷에 모든 사진을 저장하고, **Amazon CloudFront**를 사용하여 전 세계 사용자에게 낮은 지연 시간으로 사진을 전송합니다.
>
> **B.** 주 리전의 **Amazon S3** 버킷에 사진을 저장하고, **S3 교차 리전 복제(Cross-Region Replication)**를 설정하여 보조 DR 리전의 버킷으로 모든 객체를 비동기식으로 복제합니다. **Amazon CloudFront**를 사용하여 주 리전의 버킷에서 콘텐츠를 제공하도록 구성합니다.
>
> **C.** **Amazon EFS** 파일 시스템에 사진을 저장하여 여러 EC2 인스턴스가 공유하도록 합니다. **AWS Backup**을 사용하여 EFS를 다른 리전으로 주기적으로 백업하여 재해 복구에 대비합니다.
>
> **D.** 미국, 유럽, 아시아 각 리전에 S3 버킷을 생성합니다. 사용자가 사진을 업로드하면, 애플리케이션이 세 개의 버킷 모두에 사진을 동시에 업로드하도록 로직을 구현합니다.

---

### ### 풀이 및 정리

✅ **정답: B**

* **정답 분석:** 이 문제는 세 가지 요구사항을 각각 가장 잘 해결하는 서비스들을 조합하는 것이 핵심이었습니다. **`Amazon S3`**가 높은 내구성을, **`Amazon CloudFront`**가 낮은 지연 시간의 글로벌 전송을, **`S3 교차 리전 복제`**가 재해 복구를 담당하는 B가 완벽한 아키텍처입니다.

* **핵심 개념:** 글로벌 콘텐츠 서비스의 표준 패턴

| 요구사항 | **담당 AWS 서비스** | **역할** |
| :--- | :--- | :--- |
| **높은 내구성/가용성** | **Amazon S3** | 데이터의 원본 저장소 |
| **낮은 글로벌 지연 시간** | **Amazon CloudFront** | 글로벌 전송 및 엣지 캐싱 |
| **리전 단위 재해 복구** | **S3 교차 리전 복제 (CRR)** | 다른 리전에 데이터 사본 유지 |

---

## ## 문제 24: 비용/성능 최적화 - VPC 네트워크 비용 절감하기

> **시나리오:**
> 한 데이터 분석 애플리케이션이 외부 인터넷 접속이 차단된 **프라이빗 서브넷**의 EC2 인스턴스 클러스터에서 실행되고 있습니다. 이 애플리케이션은 동일한 AWS 리전에 있는 S3 버킷에서 대용량 데이터셋을 읽고, 처리 결과를 다시 S3 버킷에 쓰는 작업을 반복적으로 수행합니다. 현재 아키텍처는 EC2 인스턴스가 S3에 접근할 수 있도록 **NAT 게이트웨이**를 통해 트래픽을 라우팅하고 있으며, 이로 인해 NAT 게이트웨이의 데이터 처리 비용과 데이터 전송 비용이 부담스러운 수준으로 증가했습니다.
>
> **요구사항:**
> 1.  프라이빗 서브넷의 EC2 인스턴스가 S3에 접근할 때 발생하는 비용을 최소화해야 합니다.
> 2.  S3로의 트래픽이 인터넷을 경유하지 않도록 하여 보안을 강화하고 성능을 개선해야 합니다.
> 3.  솔루션은 안정적이고 확장 가능한 AWS 관리형 기능이어야 합니다.
>
> **문제:** 다음 중 이러한 요구사항을 가장 효과적으로 충족하는 솔루션은 무엇입니까?
>
> **A.** EC2 인스턴스와 S3 버킷이 있는 리전 간에 **VPC 피어링(Peering)** 연결을 생성하여 트래픽이 AWS 백본을 통하도록 합니다.
>
> **B.** S3 버킷에 **S3 Transfer Acceleration**을 활성화하여 EC2 인스턴스로부터의 데이터 전송 속도를 가속화하고 비용을 절감합니다.
>
> **C.** 퍼블릭 서브넷에 S3 프록시(Proxy) 서버 역할을 하는 EC2 인스턴스 그룹을 배치하고, 모든 S3 트래픽이 이 프록시를 통하도록 구성합니다.
>
> **D.** **S3에 대한 VPC 게이트웨이 엔드포인트(Gateway Endpoint)**를 생성하고, 프라이빗 서브넷의 라우팅 테이블에 이 엔드포인트를 목적지로 하는 경로를 추가합니다.

---

### ### 풀이 및 정리

✅ **정답: D**

* **정답 분석:** 이 문제를 해결하는 열쇠는 **`VPC 게이트웨이 엔드포인트`**였습니다. 이 엔드포인트는 프라이빗 서브넷에서 S3(와 DynamoDB)로 가는 트래픽을 위해 AWS 내부 네트워크에 **'비공개 통로'**를 만들어주는 기능입니다. 이 통로를 사용하면 트래픽이 더 이상 비싼 NAT 게이트웨이를 거치지 않고 S3로 바로 향하게 됩니다. 그 결과 NAT 게이트웨이 처리 비용이 완전히 사라지고, 트래픽이 인터넷을 경유하지 않아 보안과 성능까지 향상되는 일석삼조의 효과를 얻을 수 있었습니다.

* **핵심 개념:** VPC 엔드포인트 유형 비교

| 구분 | **게이트웨이 엔드포인트 (Gateway Endpoint)** | **인터페이스 엔드포인트 (Interface Endpoint)** |
| :--- | :--- | :--- |
| **지원 서비스** | **S3**, **DynamoDB** | 대부분의 AWS 서비스 (Kinesis, SQS, KMS 등) |
| **작동 방식** | 라우팅 테이블에 경로(Route)를 추가하는 방식 | 서브넷에 ENI(네트워크 인터페이스)를 생성하는 방식 |
| **비용** | **무료** | 시간당 요금 + 데이터 처리 요금 |
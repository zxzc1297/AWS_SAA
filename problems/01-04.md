# 문제 풀이 노트 (1-4편)

[↩️ 메인으로 돌아가기](../README.md)

---

## ## 문제 1: 탄력성 - 중단될 수 있는 작업을 완료시키는 방법

> **시나리오:**
> 한 미디어 회사는 비디오 트랜스코딩 애플리케이션을 AWS에서 운영하고 있습니다. 이 애플리케이션은 EC2 인스턴스에서 실행되며, S3 버킷에 업로드된 원본 비디오 파일을 처리하여 여러 포맷으로 변환한 후 다시 S3 버킷에 저장합니다. 트랜스코딩 작업은 보통 5분에서 15분 정도 소요되며, 작업 도중에 중단될 경우 처음부터 다시 시작해야 합니다.
>
> **요구사항:**
> - 비용 효율성을 위해 스팟 인스턴스를 최대한 활용해야 합니다.
> - 스팟 인스턴스가 중단되더라도 진행 중이던 작업이 완료될 수 있어야 합니다.
> - 아키텍처는 최소한의 관리 노력으로 운영되어야 합니다.
>
> **문제:** 이러한 요구사항을 가장 잘 충족하는 솔루션은 무엇일까요?
>
> **A.** SQS 대기열을 사용하여 트랜스코딩 작업을 관리합니다. EC2 Auto Scaling 그룹을 사용하여 스팟 인스턴스를 프로비저닝하고, 인스턴스가 중단되기 2분 전에 제공되는 스팟 인스턴스 중단 알림(Spot Instance interruption notice)을 감지합니다. 알림이 감지되면 진행 중인 작업을 즉시 S3에 체크포인트로 저장하고 인스턴스를 종료합니다.
>
> **B.** 사용자가 비디오를 S3에 업로드하면 Lambda 함수를 트리거하여 트랜스코딩 작업을 시작합니다. 원본 파일의 크기와 복잡성에 따라 Lambda 함수의 실행 시간이 15분을 초과할 수 있으므로, 재시도 로직을 포함하여 타임아웃이 발생하면 함수가 다시 실행되도록 설정합니다.
>
> **C.** SQS 대기열에 트랜스코딩 작업을 넣습니다. 스팟 인스턴스로 구성된 EC2 Auto Scaling 그룹을 설정하여 대기열의 메시지를 처리하도록 합니다. 스팟 인스턴스가 중단될 경우를 대비하여, Auto Scaling 그룹이 온디맨드 인스턴스를 시작하여 작업을 이어받도록 구성합니다.
>
> **D.** SQS 대기열을 사용하여 트랜스코딩 작업을 관리하고, EC2 스팟 인스턴스에서 작업자(worker) 프로세스를 실행합니다. 스팟 인스턴스가 중단 알림을 받으면, 진행 중인 작업을 완료할 수 있도록 EC2 인스턴스 재조정 권장 사항(EC2 instance rebalance recommendation)을 활성화하고, 작업이 완료될 때까지 기다린 후 인스턴스를 종료하도록 구성합니다.

---

### ### 풀이 및 정리

✅ **정답: D**

* **정답 분석:** 이 문제의 핵심은 '5~15분' 걸리는 작업을 '2분'짜리 중단 알림보다 더 먼저 인지하고 대처하는 것입니다. **EC2 인스턴스 재조정 권장 사항**은 2분 전 중단 알림보다 더 일찍, 해당 스팟 인스턴스가 중단될 위험이 높다고 알려주는 신호입니다. 이 신호를 받으면 애플리케이션은 새 작업을 받지 않고 진행 중인 작업을 마무리할 시간을 벌 수 있습니다.

* **핵심 개념:** 스팟 인스턴스 중단 처리 신호 비교

| 신호 유형 | **EC2 인스턴스 재조정 권장 사항 (Rebalance Recommendation)** | **스팟 인스턴스 중단 알림 (Interruption Notice)** |
| :--- | :--- | :--- |
| **목적** | **선제적**이고 **우아한** 작업 처리 (Graceful Draining) | **최후**의 긴급 마무리 (Checkpointing) |
| **시점** | 2분 전 중단 알림보다 **더 일찍** | 인스턴스 회수 **정확히 2분 전** |
| **권장 전략** | 새 작업 수신 중단, 진행 중인 작업 완료 시도 | 상태 저장(체크포인트), 로그 전송 등 긴급 조치 |

---

## ## 문제 2: 보안 - 외부인에게 안전하게 문 열어주기

> **시나리오:**
> 한 핀테크 회사는 외부 감사팀에게 AWS 환경에 대한 일시적인 접근 권한을 부여해야 합니다. 감사팀은 `corp-financial-logs` S3 버킷에 저장된 모든 객체를 읽고, 실행 중인 모든 EC2 인스턴스의 구성을 확인할 수 있어야 합니다.
>
> **요구사항:**
> 1. 접근 권한은 정확히 7일 동안만 유효해야 합니다.
> 2. 감사팀의 사무실 IP 주소 대역에서만 API 호출이 허용되어야 합니다.
> 3. 영구적인 자격 증명(IAM 사용자 등)을 생성하지 않고, 최소 권한 원칙을 엄격하게 준수해야 합니다.
> 4. 가장 안전하고 관리 효율성이 높은 방법을 사용해야 합니다.
>
> **문제:** 이 요구사항을 가장 잘 충족하는 솔루션은 무엇일까요?
>
> **A.** 감사팀을 위한 새 IAM 사용자를 생성하고 `AmazonS3ReadOnlyAccess` 및 `AmazonEC2ReadOnlyAccess` 관리형 정책을 연결합니다. 생성된 액세스 키를 감사팀에 전달하고, 7일 후에 수동으로 IAM 사용자를 삭제합니다.
>
> **B.** `corp-financial-logs` 버킷에 대한 버킷 정책을 수정하여 감사팀의 IP 주소에서의 접근을 허용합니다. EC2 인스턴스에 접근할 수 있도록 EC2 인스턴스의 보안 그룹에 감사팀의 IP 주소를 추가합니다.
>
> **C.** 감사팀을 위한 IAM 역할을 생성합니다. 이 역할의 신뢰 정책(Trust Policy)에서 감사팀의 AWS 계정이 이 역할을 수임(Assume)하도록 설정합니다. 역할의 권한 정책(Permissions Policy)에는 `s3:GetObject`, `s3:ListBucket` 및 `ec2:DescribeInstances` 권한을 명시하고, `Condition` 절을 사용하여 `aws:SourceIp`를 감사팀의 IP 주소로 제한합니다.
>
> **D.** AWS Lambda 함수를 작성하여 임시 액세스 키를 생성하고 감사팀에 이메일로 전송합니다. Amazon EventBridge (CloudWatch Events) 규칙을 설정하여 7일 후에 다른 Lambda 함수를 트리거하여 해당 임시 키를 비활성화하고 관련 권한을 제거하도록 합니다.

---

### ### 풀이 및 정리

✅ **정답: C**

* **정답 분석:** 외부 조직이나 제3자에게 권한을 부여하는 시나리오에서는 **IAM 역할(Role)**을 사용하는 것이 정석입니다. 신뢰 정책에 상대방의 AWS 계정을 지정하면, 상대방은 이 역할을 '수임'하여 임시 자격 증명을 얻을 수 있습니다. 여기에 권한 정책의 `Condition` 절을 사용해 IP 주소까지 제한하면 모든 요구사항을 완벽하게 충족할 수 있습니다.

* **핵심 개념:** IAM 사용자와 역할 비교

| 구분 | **IAM 사용자 (User)** | **IAM 역할 (Role)** |
| :--- | :--- | :--- |
| **자격 증명** | **영구적** (액세스 키) | **임시적** (STS를 통해 발급) |
| **주요 용도** | 사람, 오래 실행되는 애플리케이션 등 **고유한 신원** | AWS 서비스, 다른 계정, 애플리케이션에 **권한 위임** |
| **시험 키워드** | 개발자, 관리자, 영구 액세스 | EC2, Lambda, 교차 계정, 제3자 접근, 임시 접근 |

---

## ## 문제 3: 성능 - 갑자기 몰린 손님들 감당하기

> **시나리오:**
> 한 글로벌 뉴스 웹사이트는 AWS에서 운영되고 있습니다. 아키텍처는 Application Load Balancer(ALB) 뒤에 있는 EC2 인스턴스 Auto Scaling 그룹과, 기사 데이터를 저장하는 Amazon RDS for MySQL Multi-AZ 데이터베이스로 구성되어 있습니다. 긴급 속보가 터질 때마다 웹사이트에는 예측 불가능한 대규모 트래픽이 몰립니다. 이로 인해 RDS 데이터베이스의 CPU 사용률이 100%에 도달하며, 특히 홈페이지에 노출되는 인기 기사에 대한 동일한 읽기(Read) 쿼리가 반복적으로 실행되어 전체 사이트의 응답 속도가 급격히 느려지는 현상이 발생합니다.
>
> **요구사항:**
> - 트래픽 급증 시에도 최종 사용자에게 일관되게 빠른 페이지 로딩 속도를 제공해야 합니다.
> - 반복적인 읽기 요청으로 인한 RDS 데이터베이스의 부하를 최소화해야 합니다.
> - 솔루션은 높은 가용성을 가져야 합니다.
>
> **문제:** 이러한 성능 병목 현상을 해결하기 위한 가장 효과적인 방법은 무엇일까요?
>
> **A.** RDS 데이터베이스에 여러 개의 읽기 전용 복제본(Read Replicas)을 추가하고, 애플리케이션이 모든 읽기 쿼리를 이 복제본으로 보내도록 수정합니다.
>
> **B.** RDS 데이터베이스를 더 큰 인스턴스 유형으로 수직 확장(Vertically Scale)하고 프로비저닝된 IOPS(PIOPS)를 사용하여 디스크 I/O 성능을 높입니다.
>
> **C.** Amazon S3를 사용하여 모든 인기 기사를 정적 HTML 파일로 미리 생성해 저장하고, Amazon CloudFront를 통해 전 세계 사용자에게 콘텐츠를 전송합니다.
>
> **D.** 애플리케이션과 RDS 데이터베이스 사이에 Amazon ElastiCache for Redis 클러스터를 배포합니다. 애플리케이션이 데이터를 요청할 때 먼저 ElastiCache를 확인하고, 데이터가 없는 경우(cache miss)에만 데이터베이스를 쿼리하도록 수정합니다.

---

### ### 풀이 및 정리

✅ **정답: D**

* **정답 분석:** 이 문제의 핵심은 **'반복적인 동일 쿼리'**로 인한 병목 현상입니다. 이럴 때는 DB까지 요청이 도달하지 않도록 중간에 **캐시(Cache)**를 두는 것이 효과적입니다. **`Amazon ElastiCache`**는 인메모리 기반이라 DB보다 압도적으로 빠르며, 한번 조회된 데이터를 캐시에 저장해두면 이후 모든 요청은 캐시에서 바로 처리할 수 있습니다.

* **핵심 개념:** 캐시와 읽기 전용 복제본 비교

| 구분 | **캐시 (Amazon ElastiCache)** | **읽기 전용 복제본 (RDS Read Replica)** |
| :--- | :--- | :--- |
| **주 목적** | **응답 속도 향상** (지연 시간 감소) | **읽기 부하 분산** (처리량 증가) |
| **데이터** | 자주 접근하는 데이터의 **일부** (Key-Value) | 데이터베이스의 **전체 사본** (SQL) |
| **최적 사용 사례** | **동일하고 반복적인** 쿼리 (예: 인기 게시물) | **다양하고 복잡한** 읽기 쿼리 (예: BI 분석) |
| **성능** | 마이크로초 단위 (In-Memory) | 밀리초 단위 (Disk-based DB) |

---

## ## 문제 4: 비용 최적화 - 필요한 시간에만 서버 빌리기

> **시나리오:**
> 한 리테일 회사는 매일 밤 10시부터 새벽 2시까지 4시간 동안 데이터 웨어하우스를 업데이트하는 배치(batch) 처리 작업을 실행합니다. 이 작업은 예측 가능한 일정한 수의 `m5.xlarge` EC2 인스턴스를 사용합니다. 이 작업은 다음 날 아침 비즈니스 분석가들이 리포트를 사용해야 하므로 반드시 지정된 시간 안에 완료되어야 합니다.
>
> **요구사항:**
> - 야간 배치 작업의 EC2 비용을 크게 절감해야 합니다.
> - 작업이 실행되는 매일 밤 10시부터 새벽 2시까지는 컴퓨팅 용량이 반드시 보장되어야 합니다.
> - 솔루션은 예측 가능한 이 워크로드에 가장 적합해야 합니다.
>
> **문제:** 이 요구사항을 충족하는 가장 비용 효율적인 방법은 무엇일까요?
>
> **A.** 작업 시간 동안 스팟 인스턴스를 사용하도록 Auto Scaling 그룹을 구성합니다. 스팟 인스턴스는 할인율이 가장 높고, 배치 작업은 중단에 대한 내결함성을 갖도록 설계할 수 있습니다.
>
> **B.** 필요한 수의 `m5.xlarge` 인스턴스에 대해 1년 약정으로 표준 예약 인스턴스(Standard Reserved Instances)를 구매합니다.
>
> **C.** Auto Scaling 그룹에 예약된 확장(Scheduled Scaling) 정책을 설정하여, 밤 10시에 온디맨드 인스턴스를 시작하고 새벽 2시에 종료하도록 자동화합니다.
>
> **D.** 필요한 인스턴스 수량과 유형에 맞춰 **예약된 예약 인스턴스(Scheduled Reserved Instances)** 를 구매하여, 매일 밤 10시부터 새벽 2시까지 실행되도록 예약합니다.

---

### ### 풀이 및 정리

✅ **정답: D**

* **정답 분석:** 이 문제의 키워드는 **'예측 가능한 스케줄'**과 **'용량 보장'**이었습니다. **`예약된 예약 인스턴스(Scheduled RI)`**는 이 시나리오에 완벽하게 부합합니다. 원하는 특정 시간대에 대해서만 용량을 '예약'하고 '할인'을 받는 방식으로, 온디맨드보다 저렴하면서도 스팟 인스턴스와 달리 용량이 확실하게 보장되기 때문입니다.

* **핵심 개념:** 야간 배치 작업에 대한 EC2 구매 옵션 비교

| 구매 옵션 | **장점** | **단점 (이 시나리오에서)** |
| :--- | :--- | :--- |
| **스팟 인스턴스** | 가장 저렴함 | **용량 보장 안 됨 (요구사항 위반)** |
| **표준 RI** | 용량 보장, 할인율 높음 | **24시간 요금 부과 (낭비)** |
| **온디맨드** | 용량 보장, 유연함 | **비용 절감 효과 없음 (요구사항 위반)** |
| **Scheduled RI** | **용량 보장, 지정 시간만 요금 부과, 할인** | **없음 (완벽하게 부합)** |